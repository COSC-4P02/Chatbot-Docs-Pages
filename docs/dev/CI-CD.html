<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Continuous Integration and Continuous Deployment | Chatbot AI</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="Canada Games &amp; Brock University Chatbot Project">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.d3c9ab3b.js" as="script"><link rel="preload" href="/assets/js/2.79581fe1.js" as="script"><link rel="preload" href="/assets/js/9.1404e364.js" as="script"><link rel="prefetch" href="/assets/js/10.9927f78a.js"><link rel="prefetch" href="/assets/js/11.45a18cd3.js"><link rel="prefetch" href="/assets/js/12.4cd719e7.js"><link rel="prefetch" href="/assets/js/13.27d1de38.js"><link rel="prefetch" href="/assets/js/14.63d6cd24.js"><link rel="prefetch" href="/assets/js/15.b148c2be.js"><link rel="prefetch" href="/assets/js/16.5465f29f.js"><link rel="prefetch" href="/assets/js/3.65fb3cf0.js"><link rel="prefetch" href="/assets/js/4.b7d0708f.js"><link rel="prefetch" href="/assets/js/5.9e2f4ca7.js"><link rel="prefetch" href="/assets/js/6.c7b54f12.js"><link rel="prefetch" href="/assets/js/7.9045ca36.js"><link rel="prefetch" href="/assets/js/8.2969cecb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Chatbot AI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/guide/getting-started.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="more" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="more" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Use
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/use/deploy.html" class="nav-link">
  Deploy
</a></li><li class="dropdown-subitem"><a href="/use/dev.html" class="nav-link">
  Development
</a></li></ul></li><li class="dropdown-item"><h4>
          Development
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/train-data.html" class="nav-link">
  Train Data
</a></li><li class="dropdown-subitem"><a href="/dev/config.html" class="nav-link">
  Config File
</a></li><li class="dropdown-subitem"><a href="/dev/CI-CD.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  CI/CD
</a></li><li class="dropdown-subitem"><a href="/dev/hook.html" class="nav-link">
  Hook
</a></li></ul></li><li class="dropdown-item"><h4>
          API
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/api/chat.html" class="nav-link">
  Chatbot Api
</a></li></ul></li><li class="dropdown-item"><h4>
          Code
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/code/open-source.html" class="nav-link">
  Open Source
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/COSC-4P02" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://chatbot-ai.ga" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/guide/getting-started.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="more" class="dropdown-title"><span class="title">More</span> <span class="arrow down"></span></button> <button type="button" aria-label="more" class="mobile-dropdown-title"><span class="title">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Use
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/use/deploy.html" class="nav-link">
  Deploy
</a></li><li class="dropdown-subitem"><a href="/use/dev.html" class="nav-link">
  Development
</a></li></ul></li><li class="dropdown-item"><h4>
          Development
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev/train-data.html" class="nav-link">
  Train Data
</a></li><li class="dropdown-subitem"><a href="/dev/config.html" class="nav-link">
  Config File
</a></li><li class="dropdown-subitem"><a href="/dev/CI-CD.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  CI/CD
</a></li><li class="dropdown-subitem"><a href="/dev/hook.html" class="nav-link">
  Hook
</a></li></ul></li><li class="dropdown-item"><h4>
          API
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/api/chat.html" class="nav-link">
  Chatbot Api
</a></li></ul></li><li class="dropdown-item"><h4>
          Code
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/code/open-source.html" class="nav-link">
  Open Source
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/COSC-4P02" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://chatbot-ai.ga" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="continuous-integration-and-continuous-deployment"><a href="#continuous-integration-and-continuous-deployment" class="header-anchor">#</a> Continuous Integration and Continuous Deployment</h1> <p>After commit into this repo, CircleCi will run unit testing automatically, and Github Workflow will build and push the Docker Image to Docker Hub, our server is always listening the update for the docker image, if the digest is changed for the latest version, server will automatically pull the image and rebuilt the container.</p> <h2 id="circleci-config"><a href="#circleci-config" class="header-anchor">#</a> CircleCi Config</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>version: <span class="token number">2.1</span>

orbs:
  node: circleci/node@4.7

jobs:
  build_backend:
    working_directory: ~/circleci/Backend/
    executor: node/default
    steps:
      - checkout:
          path: ~/circleci/
      - run:
          command: <span class="token function">ls</span>
      - node/install-npm
      - restore_cache:
          key: dependency-cache-<span class="token punctuation">{</span><span class="token punctuation">{</span> checksum <span class="token string">&quot;package-lock.json&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
      - node/install-packages:
          app-dir: ~/circleci/Backend/
          cache-path: node_modules
          override-ci-command: <span class="token function">npm</span> i
      - save_cache:
          key: dependency-cache-<span class="token punctuation">{</span><span class="token punctuation">{</span> checksum <span class="token string">&quot;package-lock.json&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
          paths:
            - ./node_modules
      - persist_to_workspace:
          root: <span class="token builtin class-name">.</span>
          paths:
            - <span class="token builtin class-name">.</span>
  build_frontend:
    working_directory: ~/circleci/Frontend/
    executor: node/default
    steps:
      - checkout:
          path: ~/circleci/
      - run:
          command: <span class="token function">ls</span>
      - node/install-yarn
      - restore_cache:
          key: dependency-cache-<span class="token punctuation">{</span><span class="token punctuation">{</span> checksum <span class="token string">&quot;yarn.lock&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
      - node/install-packages:
          app-dir: ~/circleci/Frontend/
          cache-path: node_modules
          override-ci-command: <span class="token function">yarn</span>
      - save_cache:
          key: dependency-cache-<span class="token punctuation">{</span><span class="token punctuation">{</span> checksum <span class="token string">&quot;yarn.lock&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
          paths:
            - ./node_modules
      - persist_to_workspace:
          root: <span class="token builtin class-name">.</span>
          paths:
            - <span class="token builtin class-name">.</span>

  test_backend:
    working_directory: ~/circleci/Backend/
    docker:
      - image: cimg/node:current
    steps:
      - attach_workspace:
          at: <span class="token builtin class-name">.</span>
      - run:
          name: Backend Test
          command: <span class="token function">npm</span> <span class="token builtin class-name">test</span>

  lint_backend:
    working_directory: ~/circleci/Backend/
    docker:
      - image: cimg/node:current
    steps:
      - attach_workspace:
          at: <span class="token builtin class-name">.</span>
      - run:
          name: Backend Lint Test
          command: <span class="token function">npm</span> run lint

  lint_frontend:
    working_directory: ~/circleci/Frontend/
    docker:
      - image: cimg/node:current
    steps:
      - attach_workspace:
          at: <span class="token builtin class-name">.</span>
      - run:
          name: Frontend Lint Test
          command: <span class="token function">yarn</span> lint

workflows:
  version: <span class="token number">2</span>
  build_and_test:
    jobs:
      - build_backend
      - test_backend:
          requires:
            - build_backend
      - lint_backend:
          requires:
            - build_backend
      - build_frontend
      - lint_frontend:
          requires:
            - build_frontend
</code></pre></div><h2 id="docker-workflow"><a href="#docker-workflow" class="header-anchor">#</a> Docker Workflow</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>name: Docker Continuous Deployment

on:
  push:
    paths:
      - <span class="token string">'Backend/**'</span>
      - <span class="token string">'Backend/**/**'</span>
      - <span class="token string">'Backend/**/**/**'</span>
      - <span class="token string">'Backend/**/**/**/**'</span>
  pull_request:
    paths:
      - Backend

defaults:
  run:
    working-directory: ./Backend

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - run: <span class="token operator">|</span>
        <span class="token function">docker</span> run --privileged --rm tonistiigi/binfmt --install all
        <span class="token function">docker</span> login -u<span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${{ secrets.DOCKER_UN }</span>}&quot;</span> -p<span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${{ secrets.DOCKER_PW }</span>}&quot;</span>
        <span class="token function">docker</span> buildx create --name krunkbuilder
        <span class="token function">docker</span> buildx <span class="token function">ls</span>
        <span class="token function">docker</span> buildx use krunkbuilder
    - name: Build the Docker image <span class="token function">date</span>
      run: <span class="token function">docker</span> buildx build <span class="token builtin class-name">.</span> -t krunk/chatbot-ai-backend:<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span> --platform<span class="token operator">=</span>linux/arm64,linux/amd64 --push
    - name: Build the Docker image latest
      run: <span class="token function">docker</span> buildx build <span class="token builtin class-name">.</span> -t krunk/chatbot-ai-backend:latest --platform<span class="token operator">=</span>linux/arm64,linux/amd64 --push
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d3c9ab3b.js" defer></script><script src="/assets/js/2.79581fe1.js" defer></script><script src="/assets/js/9.1404e364.js" defer></script>
  </body>
</html>
